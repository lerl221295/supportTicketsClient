#import "../fragments/ticketStatusAndTypes.graphql"
#import "../fragments/ticketsFragment.graphql"
query GetTicketDetailsAndMetadata($number: Int!) {
	ticket(number: $number) {
		...ticketsFields
		response_by
		next_states {
			key
			label
		}
		client {
			name: fullName
			email
			phones
			address
			organization {
				id
				name
			}
			devices {
				code
				name
			}
		}
		agent {
			name: fullName
			face_base64
			email
			profession
		}
		group {
			id
			name
			group_scale {
				name
			}
		}
		supplier {
			id
			name
		}
		tasks {
			text
			done
		}
		interventions {
			time
			text
			type_autor
			autor {
				...on Agent {
					id
					name: fullName
					face_base64
				}
			}
		}
		activities {
			type
			...on UpgradeActivity {
				time
				type_autor
				autor {
					id
					name: fullName
					face_base64
				}
				actions {
					...on UpgradeActivityActionUpdate {
						type
						prop_name
						new_value
					}
					...on UpgradeActivityActionAssignment {
						type
						bearer {
							...on Agent {
								id
								name: fullName
							}
							...on Supplier {
								id
								name
							}
							...on Group {
								id
								name
							}
						}
					}
				}
			}
		}
	}
	ticketMetadata {
		...statusAndTypes
		custom_fields {
			type 
			key
			position
			label
			... on SelectField {
				options {
					label
					key
					position
				}
			}
			value(ticket_number: $number) {
		        ...on TextValue {
					text
				}
				...on NumberValue {
					number
				}
				...on CheckValue {
					check
				}
				...on SelectValue {
					key
				}
		    }
		}
	}
}